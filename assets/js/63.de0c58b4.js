(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{338:function(t,e,s){"use strict";s.r(e);var a=s(14),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"jenkins-learning"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-learning"}},[t._v("#")]),t._v(" Jenkins Learning")]),t._v(" "),e("h2",{attrs:{id:"jenkis-terraform-architecture"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jenkis-terraform-architecture"}},[t._v("#")]),t._v(" Jenkis Terraform Architecture")]),t._v(" "),e("h3",{attrs:{id:"vpc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vpc"}},[t._v("#")]),t._v(" VPC")]),t._v(" "),e("p",[e("strong",[t._v("VPC Config")])]),t._v(" "),e("ul",[e("li",[t._v("IPv4 CIDR: "),e("code",[t._v("10.0.0.0/16")])])]),t._v(" "),e("p",[e("strong",[t._v("Subnets")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Private Subnets x2")]),t._v(" "),e("ul",[e("li",[t._v("Private Subnet 1:\n"),e("ul",[e("li",[t._v("IPv4 CIDR: "),e("code",[t._v("10.0.2.0/24")])])])]),t._v(" "),e("li",[t._v("Private Subnet 2:\n"),e("ul",[e("li",[t._v("IPv4 CIDR: "),e("code",[t._v("10.0.3.0/24")])])])])])]),t._v(" "),e("li",[e("p",[t._v("Public Subnets x2")]),t._v(" "),e("ul",[e("li",[t._v("Public Subnet 1:\n"),e("ul",[e("li",[t._v("IPv4 CIDR: "),e("code",[t._v("10.0.0.0/24")])]),t._v(" "),e("li",[t._v("Auto Assign IP Address: "),e("code",[t._v("True")])])])]),t._v(" "),e("li",[t._v("Public Subnet 2:\n"),e("ul",[e("li",[t._v("IPv4 CIDR: "),e("code",[t._v("10.0.1.0/24")])]),t._v(" "),e("li",[t._v("Auto Assign IP Address: "),e("code",[t._v("True")])])])])])]),t._v(" "),e("li",[e("p",[t._v("Router Tables x3:")]),t._v(" "),e("ul",[e("li",[t._v("Public Router Table:\n"),e("ul",[e("li",[t._v("Routes Target -> From "),e("code",[t._v("0.0.0.0/0")]),t._v(" to "),e("code",[t._v("Internet Gateway")])]),t._v(" "),e("li",[t._v("Associations: Public Subnets")])])]),t._v(" "),e("li",[t._v("Private Router Table 1:\n"),e("ul",[e("li",[t._v("Routes Target -> From "),e("code",[t._v("0.0.0.0/0")]),t._v(" to "),e("code",[t._v("NAT Gateway")])]),t._v(" "),e("li",[t._v("Private Subnet 1")])])]),t._v(" "),e("li",[t._v("Private Router Table 2:\n"),e("ul",[e("li",[t._v("Routes Target -> From "),e("code",[t._v("0.0.0.0/0")]),t._v(" to "),e("code",[t._v("NAT Gateway")])]),t._v(" "),e("li",[t._v("Private Subnet 2")])])])])])]),t._v(" "),e("p",[e("strong",[t._v("Internet Gateway")])]),t._v(" "),e("p",[t._v("Attached to VPC")]),t._v(" "),e("p",[e("strong",[t._v("Elastic IP IDs")])]),t._v(" "),e("ul",[e("li",[t._v("Associated to "),e("code",[t._v("Nat Gateways")])])]),t._v(" "),e("p",[e("strong",[t._v("Nat Gateways")])]),t._v(" "),e("ul",[e("li",[t._v("One per Public Subnet")])]),t._v(" "),e("p",[e("strong",[t._v("Network ACL")])]),t._v(" "),e("ul",[e("li",[t._v("Associated with all 4 Subnets")]),t._v(" "),e("li",[t._v("Inbound Rules:\n"),e("ul",[e("li",[t._v("Source "),e("code",[t._v("0.0.0.0/0")]),t._v(" - Rule Number "),e("code",[t._v("100")]),t._v(" - Type "),e("code",[t._v("All traffic")])])])]),t._v(" "),e("li",[t._v("Outbound Rules:\n"),e("ul",[e("li",[t._v("Source "),e("code",[t._v("0.0.0.0/0")]),t._v(" - Rule Number "),e("code",[t._v("100")]),t._v(" - Type "),e("code",[t._v("All traffic")])])])])]),t._v(" "),e("p",[e("strong",[t._v("Security Groups")])]),t._v(" "),e("ul",[e("li",[t._v("Load Balancer SG\n"),e("ul",[e("li",[t._v("Inbound Rules: "),e("code",[t._v("HTTPS")]),t._v(" - "),e("code",[t._v("443")]),t._v(" - "),e("code",[t._v("0.0.0.0/0")])]),t._v(" "),e("li",[t._v("Outbound Rules: "),e("code",[t._v("8080")]),t._v(" - "),e("code",[t._v("JenkinsSecurityGroup")])])])]),t._v(" "),e("li",[t._v("Jenkins SG\n"),e("ul",[e("li",[t._v("Inbound Rules: "),e("code",[t._v("TCP")]),t._v(" - "),e("code",[t._v("8080")]),t._v(" - "),e("code",[t._v("0.0.0.0/0")])]),t._v(" "),e("li",[t._v("Outbound Rules: "),e("code",[t._v("All traffic")]),t._v(" - "),e("code",[t._v("0.0.0.0/0")])])])]),t._v(" "),e("li",[t._v("Jenkins EFS\n"),e("ul",[e("li",[t._v("Inbound Rules: "),e("code",[t._v("TCP")]),t._v(" - "),e("code",[t._v("2049")]),t._v(" - "),e("code",[t._v("JenkinsSecurityGroup")])]),t._v(" "),e("li",[t._v("Outbound Rules: "),e("code",[t._v("All traffic")]),t._v(" - "),e("code",[t._v("0.0.0.0/0")])])])])]),t._v(" "),e("h2",{attrs:{id:"ec2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ec2"}},[t._v("#")]),t._v(" EC2")]),t._v(" "),e("p",[e("strong",[t._v("Load Balancer")])]),t._v(" "),e("ul",[e("li",[t._v("Attributes:\n"),e("ul",[e("li",[t._v("HTTP LB")]),t._v(" "),e("li",[t._v("Internet-facing scheme")]),t._v(" "),e("li",[t._v("Subnets: "),e("code",[t._v("Public Subnet 1")]),t._v(" & "),e("code",[t._v("Public Subnet 2")])])])]),t._v(" "),e("li",[t._v("Security Group: "),e("code",[t._v("Load Balancer SG")])]),t._v(" "),e("li",[t._v("Listener:\n"),e("ul",[e("li",[t._v("HTTP 443")]),t._v(" "),e("li",[t._v("Certification from DNS")])])]),t._v(" "),e("li",[t._v("Forwarding:\n"),e("ul",[e("li",[t._v("To "),e("code",[t._v("JenkinsTargetGroup")]),t._v(":\n"),e("ul",[e("li",[t._v("Target: "),e("code",[t._v("10.0.3.81")]),t._v(" - "),e("code",[t._v("8080")]),t._v(" -")])])])])])]),t._v(" "),e("h2",{attrs:{id:"resources"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resources"}},[t._v("#")]),t._v(" Resources")]),t._v(" "),e("h4",{attrs:{id:"install-jenkins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-jenkins"}},[t._v("#")]),t._v(" Install Jenkins")]),t._v(" "),e("p",[t._v("Install Java")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" openjdk-8-jdk\n")])])]),e("p",[t._v("Install Jenkins")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-q")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-O")]),t._v(" - https://pkg.jenkins.io/debian-stable/jenkins.io.key "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" apt-key "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" -\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'echo deb https://pkg.jenkins.io/debian-stable binary/ > \\\n    /etc/apt/sources.list.d/jenkins.list'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" jenkins\n")])])]),e("p",[t._v("After installing run")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start jenkins\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /var/lib/jenkins/secrets/initialAdminPassword\n")])])]),e("p",[t._v("To run commands as "),e("code",[t._v("sudo")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v("  /etc/sudoers\njenkins "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ALL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ALL"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" NOPASSWD: ALL\n")])])]),e("h4",{attrs:{id:"things-to-consider-for-installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#things-to-consider-for-installation"}},[t._v("#")]),t._v(" Things to Consider for Installation")]),t._v(" "),e("ol",[e("li",[t._v("Make sure Jenkins user can run "),e("code",[t._v("sudo")]),t._v(" commands.")]),t._v(" "),e("li",[t._v("Be mindful of the Terraform state.")]),t._v(" "),e("li",[t._v("Get the right plugins and credentials in place.")]),t._v(" "),e("li",[t._v("Make sure AWS Resources have the right accesses.")])])])}),[],!1,null,null,null);e.default=n.exports}}]);