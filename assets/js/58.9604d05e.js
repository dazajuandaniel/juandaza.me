(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{415:function(t,e,s){"use strict";s.r(e);var n=s(42),a=Object(n.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"jenkins-learning"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-learning"}},[t._v("#")]),t._v(" Jenkins Learning")]),t._v(" "),s("h2",{attrs:{id:"jenkis-terraform-architecture"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkis-terraform-architecture"}},[t._v("#")]),t._v(" Jenkis Terraform Architecture")]),t._v(" "),s("h3",{attrs:{id:"vpc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vpc"}},[t._v("#")]),t._v(" VPC")]),t._v(" "),s("p",[s("strong",[t._v("VPC Config")])]),t._v(" "),s("ul",[s("li",[t._v("IPv4 CIDR: "),s("code",[t._v("10.0.0.0/16")])])]),t._v(" "),s("p",[s("strong",[t._v("Subnets")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Private Subnets x2")]),t._v(" "),s("ul",[s("li",[t._v("Private Subnet 1:\n"),s("ul",[s("li",[t._v("IPv4 CIDR: "),s("code",[t._v("10.0.2.0/24")])])])]),t._v(" "),s("li",[t._v("Private Subnet 2:\n"),s("ul",[s("li",[t._v("IPv4 CIDR: "),s("code",[t._v("10.0.3.0/24")])])])])])]),t._v(" "),s("li",[s("p",[t._v("Public Subnets x2")]),t._v(" "),s("ul",[s("li",[t._v("Public Subnet 1:\n"),s("ul",[s("li",[t._v("IPv4 CIDR: "),s("code",[t._v("10.0.0.0/24")])]),t._v(" "),s("li",[t._v("Auto Assign IP Address: "),s("code",[t._v("True")])])])]),t._v(" "),s("li",[t._v("Public Subnet 2:\n"),s("ul",[s("li",[t._v("IPv4 CIDR: "),s("code",[t._v("10.0.1.0/24")])]),t._v(" "),s("li",[t._v("Auto Assign IP Address: "),s("code",[t._v("True")])])])])])]),t._v(" "),s("li",[s("p",[t._v("Router Tables x3:")]),t._v(" "),s("ul",[s("li",[t._v("Public Router Table:\n"),s("ul",[s("li",[t._v("Routes Target -> From "),s("code",[t._v("0.0.0.0/0")]),t._v(" to "),s("code",[t._v("Internet Gateway")])]),t._v(" "),s("li",[t._v("Associations: Public Subnets")])])]),t._v(" "),s("li",[t._v("Private Router Table 1:\n"),s("ul",[s("li",[t._v("Routes Target -> From "),s("code",[t._v("0.0.0.0/0")]),t._v(" to "),s("code",[t._v("NAT Gateway")])]),t._v(" "),s("li",[t._v("Private Subnet 1")])])]),t._v(" "),s("li",[t._v("Private Router Table 2:\n"),s("ul",[s("li",[t._v("Routes Target -> From "),s("code",[t._v("0.0.0.0/0")]),t._v(" to "),s("code",[t._v("NAT Gateway")])]),t._v(" "),s("li",[t._v("Private Subnet 2")])])])])])]),t._v(" "),s("p",[s("strong",[t._v("Internet Gateway")])]),t._v(" "),s("p",[t._v("Attached to VPC")]),t._v(" "),s("p",[s("strong",[t._v("Elastic IP IDs")])]),t._v(" "),s("ul",[s("li",[t._v("Associated to "),s("code",[t._v("Nat Gateways")])])]),t._v(" "),s("p",[s("strong",[t._v("Nat Gateways")])]),t._v(" "),s("ul",[s("li",[t._v("One per Public Subnet")])]),t._v(" "),s("p",[s("strong",[t._v("Network ACL")])]),t._v(" "),s("ul",[s("li",[t._v("Associated with all 4 Subnets")]),t._v(" "),s("li",[t._v("Inbound Rules:\n"),s("ul",[s("li",[t._v("Source "),s("code",[t._v("0.0.0.0/0")]),t._v(" - Rule Number "),s("code",[t._v("100")]),t._v(" - Type "),s("code",[t._v("All traffic")])])])]),t._v(" "),s("li",[t._v("Outbound Rules:\n"),s("ul",[s("li",[t._v("Source "),s("code",[t._v("0.0.0.0/0")]),t._v(" - Rule Number "),s("code",[t._v("100")]),t._v(" - Type "),s("code",[t._v("All traffic")])])])])]),t._v(" "),s("p",[s("strong",[t._v("Security Groups")])]),t._v(" "),s("ul",[s("li",[t._v("Load Balancer SG\n"),s("ul",[s("li",[t._v("Inbound Rules: "),s("code",[t._v("HTTPS")]),t._v(" - "),s("code",[t._v("443")]),t._v(" - "),s("code",[t._v("0.0.0.0/0")])]),t._v(" "),s("li",[t._v("Outbound Rules: "),s("code",[t._v("8080")]),t._v(" - "),s("code",[t._v("JenkinsSecurityGroup")])])])]),t._v(" "),s("li",[t._v("Jenkins SG\n"),s("ul",[s("li",[t._v("Inbound Rules: "),s("code",[t._v("TCP")]),t._v(" - "),s("code",[t._v("8080")]),t._v(" - "),s("code",[t._v("0.0.0.0/0")])]),t._v(" "),s("li",[t._v("Outbound Rules: "),s("code",[t._v("All traffic")]),t._v(" - "),s("code",[t._v("0.0.0.0/0")])])])]),t._v(" "),s("li",[t._v("Jenkins EFS\n"),s("ul",[s("li",[t._v("Inbound Rules: "),s("code",[t._v("TCP")]),t._v(" - "),s("code",[t._v("2049")]),t._v(" - "),s("code",[t._v("JenkinsSecurityGroup")])]),t._v(" "),s("li",[t._v("Outbound Rules: "),s("code",[t._v("All traffic")]),t._v(" - "),s("code",[t._v("0.0.0.0/0")])])])])]),t._v(" "),s("h2",{attrs:{id:"ec2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ec2"}},[t._v("#")]),t._v(" EC2")]),t._v(" "),s("p",[s("strong",[t._v("Load Balancer")])]),t._v(" "),s("ul",[s("li",[t._v("Attributes:\n"),s("ul",[s("li",[t._v("HTTP LB")]),t._v(" "),s("li",[t._v("Internet-facing scheme")]),t._v(" "),s("li",[t._v("Subnets: "),s("code",[t._v("Public Subnet 1")]),t._v(" & "),s("code",[t._v("Public Subnet 2")])])])]),t._v(" "),s("li",[t._v("Security Group: "),s("code",[t._v("Load Balancer SG")])]),t._v(" "),s("li",[t._v("Listener:\n"),s("ul",[s("li",[t._v("HTTP 443")]),t._v(" "),s("li",[t._v("Certification from DNS")])])]),t._v(" "),s("li",[t._v("Forwarding:\n"),s("ul",[s("li",[t._v("To "),s("code",[t._v("JenkinsTargetGroup")]),t._v(":\n"),s("ul",[s("li",[t._v("Target: "),s("code",[t._v("10.0.3.81")]),t._v(" - "),s("code",[t._v("8080")]),t._v(" -")])])])])])]),t._v(" "),s("h2",{attrs:{id:"resources"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#resources"}},[t._v("#")]),t._v(" Resources")]),t._v(" "),s("h4",{attrs:{id:"install-jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-jenkins"}},[t._v("#")]),t._v(" Install Jenkins")]),t._v(" "),s("p",[t._v("Install Java")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" openjdk-8-jdk\n")])])]),s("p",[t._v("Install Jenkins")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" apt-key "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" -\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" -c "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'echo deb https://pkg.jenkins.io/debian-stable binary/ > \\\n    /etc/apt/sources.list.d/jenkins.list'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" jenkins\n")])])]),s("p",[t._v("After installing run")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start jenkins\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /var/lib/jenkins/secrets/initialAdminPassword\n")])])]),s("p",[t._v("To run commands as "),s("code",[t._v("sudo")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v("  /etc/sudoers\njenkins "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ALL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ALL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" NOPASSWD: ALL\n")])])]),s("h4",{attrs:{id:"things-to-consider-for-installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#things-to-consider-for-installation"}},[t._v("#")]),t._v(" Things to Consider for Installation")]),t._v(" "),s("ol",[s("li",[t._v("Make sure Jenkins user can run "),s("code",[t._v("sudo")]),t._v(" commands.")]),t._v(" "),s("li",[t._v("Be mindful of the Terraform state.")]),t._v(" "),s("li",[t._v("Get the right plugins and credentials in place.")]),t._v(" "),s("li",[t._v("Make sure AWS Resources have the right accesses.")])])])}),[],!1,null,null,null);e.default=a.exports}}]);