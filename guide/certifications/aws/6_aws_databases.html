<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RDS &amp; ElasticCache | Juan Daza</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="manifest" href="/favicons/site.webmanifest">
    <meta name="description" content="Personal Site - Data Science">
    <meta name="msapplication-TileColor" content="#3a0839">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.155411b8.css" as="style"><link rel="preload" href="/assets/js/app.35aca26c.js" as="script"><link rel="preload" href="/assets/js/2.c8d9d072.js" as="script"><link rel="preload" href="/assets/js/24.c946bec5.js" as="script"><link rel="prefetch" href="/assets/js/10.d1ce74f6.js"><link rel="prefetch" href="/assets/js/11.db0c7ded.js"><link rel="prefetch" href="/assets/js/12.0e8bfade.js"><link rel="prefetch" href="/assets/js/13.d2c3f67c.js"><link rel="prefetch" href="/assets/js/14.a5cb3f2e.js"><link rel="prefetch" href="/assets/js/15.ccfe6919.js"><link rel="prefetch" href="/assets/js/16.bb6c67c5.js"><link rel="prefetch" href="/assets/js/17.8686cb17.js"><link rel="prefetch" href="/assets/js/18.5ac61ac7.js"><link rel="prefetch" href="/assets/js/19.ec52a77c.js"><link rel="prefetch" href="/assets/js/20.1d7621d9.js"><link rel="prefetch" href="/assets/js/21.4d2f0a20.js"><link rel="prefetch" href="/assets/js/22.8b43a882.js"><link rel="prefetch" href="/assets/js/23.6f476c24.js"><link rel="prefetch" href="/assets/js/25.5389aff6.js"><link rel="prefetch" href="/assets/js/26.5af7ef7a.js"><link rel="prefetch" href="/assets/js/27.88109595.js"><link rel="prefetch" href="/assets/js/28.d8ac5fbb.js"><link rel="prefetch" href="/assets/js/29.a0b01f59.js"><link rel="prefetch" href="/assets/js/3.4039a9f7.js"><link rel="prefetch" href="/assets/js/30.58976856.js"><link rel="prefetch" href="/assets/js/31.d7c9b549.js"><link rel="prefetch" href="/assets/js/32.28bf3cab.js"><link rel="prefetch" href="/assets/js/33.364f88a5.js"><link rel="prefetch" href="/assets/js/34.728be2c6.js"><link rel="prefetch" href="/assets/js/35.70456731.js"><link rel="prefetch" href="/assets/js/36.ba313a91.js"><link rel="prefetch" href="/assets/js/37.8c2266b6.js"><link rel="prefetch" href="/assets/js/38.eb3eab3e.js"><link rel="prefetch" href="/assets/js/39.301db930.js"><link rel="prefetch" href="/assets/js/4.b67d13f0.js"><link rel="prefetch" href="/assets/js/40.ef12ad0e.js"><link rel="prefetch" href="/assets/js/41.38f27281.js"><link rel="prefetch" href="/assets/js/42.ee9177c2.js"><link rel="prefetch" href="/assets/js/43.2b737049.js"><link rel="prefetch" href="/assets/js/44.abbde545.js"><link rel="prefetch" href="/assets/js/45.bf572075.js"><link rel="prefetch" href="/assets/js/46.b2e60712.js"><link rel="prefetch" href="/assets/js/47.405cfe05.js"><link rel="prefetch" href="/assets/js/48.ce2f27b9.js"><link rel="prefetch" href="/assets/js/49.466b3665.js"><link rel="prefetch" href="/assets/js/5.cf6f72c1.js"><link rel="prefetch" href="/assets/js/50.c5b3cb4a.js"><link rel="prefetch" href="/assets/js/51.f49c845d.js"><link rel="prefetch" href="/assets/js/52.9848a4cb.js"><link rel="prefetch" href="/assets/js/53.a8324336.js"><link rel="prefetch" href="/assets/js/54.ee7c16dc.js"><link rel="prefetch" href="/assets/js/55.22d1c3a5.js"><link rel="prefetch" href="/assets/js/56.beb45d0c.js"><link rel="prefetch" href="/assets/js/57.721a3b94.js"><link rel="prefetch" href="/assets/js/58.9604d05e.js"><link rel="prefetch" href="/assets/js/59.7756dbd5.js"><link rel="prefetch" href="/assets/js/6.3c6a86b6.js"><link rel="prefetch" href="/assets/js/60.5e996d10.js"><link rel="prefetch" href="/assets/js/61.d69508c5.js"><link rel="prefetch" href="/assets/js/62.86884ca2.js"><link rel="prefetch" href="/assets/js/63.4046b076.js"><link rel="prefetch" href="/assets/js/64.58bf25b4.js"><link rel="prefetch" href="/assets/js/65.c319b47d.js"><link rel="prefetch" href="/assets/js/66.f634ab4a.js"><link rel="prefetch" href="/assets/js/67.ce7ec7d8.js"><link rel="prefetch" href="/assets/js/7.e1ae24ba.js"><link rel="prefetch" href="/assets/js/8.c0963d9f.js"><link rel="prefetch" href="/assets/js/9.18a35f9e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.155411b8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/photo.png" alt="Juan Daza" class="logo"> <span class="site-name can-hide">Juan Daza</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/cv.html" class="nav-link">
  CV
</a></div><div class="nav-item"><a href="https://www.linkedin.com/in/juandanieldaza" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LinkedIn
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/cv.html" class="nav-link">
  CV
</a></div><div class="nav-item"><a href="https://www.linkedin.com/in/juandanieldaza" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LinkedIn
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Help Snippets</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/guide/algos/" class="sidebar-link">Machine Learning</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Machine Learning</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Graphs</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/guide/mlops/" class="sidebar-link">ML OPS</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Ml Ops</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/guide/databricks/" class="sidebar-link">Databricks</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Databricks</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="rds-elasticcache"><a href="#rds-elasticcache" class="header-anchor">#</a> RDS &amp; ElasticCache</h1> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>Managed Relational Database Service</p> <ul><li>Postgre</li> <li>MySQL</li> <li>MariaDB</li> <li>SQL Server</li> <li>Oracle</li> <li>Aurora</li></ul> <p><strong>Benefits</strong></p> <ol><li>Provisioning is automated</li> <li>Continuos backups and restore to specific timestamp</li> <li>Read replicas for performance improvement</li> <li>Multi AZ setup for DR</li> <li>Maintenance Windows</li> <li>Scaling capability</li> <li>Storaged backed by EBS (<code>gp2</code> or <code>io1</code>)</li></ol> <p><strong>Backups</strong></p> <ul><li>Automatically enabled by default</li> <li>Transaction logs are done every 5 mins.</li> <li>7-day retention (increased to 35 days)</li></ul> <p><strong>Snapshots</strong></p> <ul><li>Triggered by user</li> <li>Retention is up to user</li></ul> <p><strong>RDS AutoScaling</strong></p> <ul><li>Increases storage dynamically -&gt; Avoid manual scaling, useful for unpredictable workloads</li> <li>User has to set <em>Maximum Storage Threshold</em></li></ul> <h2 id="read-replicas-vs-multi-az"><a href="#read-replicas-vs-multi-az" class="header-anchor">#</a> Read Replicas vs Multi AZ</h2> <h3 id="read-replicas"><a href="#read-replicas" class="header-anchor">#</a> Read Replicas</h3> <p><img src="/images/rds_read_replica.png" alt="rds_read_replica"></p> <p>Helps scale <code>reads</code>, user can:</p> <ul><li>Set up to 5 read replicas within AZ, cross AZ or cross region</li> <li>Replication is <strong>Async</strong> -&gt; reads are eventually consistent.</li> <li>Replicas can be promoted to their own database.</li> <li><strong>Note</strong> -&gt; Applications must update the connection string to leverage the read replicas.</li></ul> <p><strong>Network Costs</strong></p> <ul><li>If Read Replica are within the same region, there are NO networking costs.</li> <li>For Cross Region replica, will incur in a replication fee for network</li></ul> <h3 id="multi-az"><a href="#multi-az" class="header-anchor">#</a> Multi AZ</h3> <p><img src="/images/rds_multi_az.png" alt="rds_multi_az"></p> <p>Uses <strong>Sync</strong> replication</p> <ul><li>Writes need to be replicated to be accepted</li> <li>Get one DNS name</li> <li>Increases availability and failover</li> <li>No manual intervention in Apps</li></ul> <p>To go from Single AZ to Multi AZ:</p> <ul><li>Zero downtime operation, just click on <code>modify</code> in the DB settings
What happens is that a snapshot is taken and restored into a new standby DB. Then Sync is established.</li></ul> <h2 id="encryption-security"><a href="#encryption-security" class="header-anchor">#</a> Encryption &amp; Security</h2> <h3 id="encryption"><a href="#encryption" class="header-anchor">#</a> Encryption</h3> <p>At rest encryption:</p> <ul><li>Possibility to encrypt master &amp; read. <em>If master is not encrypted, replicas can't be encrypted</em></li> <li>Transparent Data Encryption (TDE) is available for Oraacle and SQL Server</li></ul> <p>In flight encryption:</p> <ul><li>SSL certificates to encrypt data</li> <li>User can enforce SSL</li></ul> <p><strong>Encryption Operations</strong></p> <p>RDS Backups:</p> <ul><li>Snapshots of unencrypted DBs are unencrypted</li> <li>Snapshots of encrypted DBs are encrypted</li> <li>Users can copy a snapshot unencrypted and then create an encrypted version.
<ol><li>Create a snapshot</li> <li>Copy and enable encryption</li> <li>Restore DB from encrypted version</li> <li>Migrate applications to new DB and delete old DB.</li></ol></li></ul> <h3 id="security"><a href="#security" class="header-anchor">#</a> Security</h3> <p>RDS are usually deployed in a private subnet, not a public one and works by leveraging security groups.</p> <p><strong>Access Management</strong></p> <ul><li>IAM policies help control who can manage the RDS</li> <li>Tradition Username/Pwd can be used to login the DB</li> <li>IAM-Based authentication can be used to login into the RDS only for <code>MySQL</code> &amp; <code>Postgre</code></li></ul> <h2 id="aurora"><a href="#aurora" class="header-anchor">#</a> Aurora</h2> <h3 id="overview-2"><a href="#overview-2" class="header-anchor">#</a> Overview</h3> <p>It's a propietary technology from AWS. Both MySQL &amp; MariaDB are supported -&gt; it's cloud optimized.</p> <ul><li>Automatically grows up to 64TBs</li> <li>Can have up to 15 replicas (MySQL has 5)</li> <li>Failover is instantaneous (HA native)</li> <li>Industry Compliance</li> <li>20% more expensive</li> <li>Provides a Serverless type</li> <li>Storage is done across AZ</li></ul> <h3 id="aurora-ha"><a href="#aurora-ha" class="header-anchor">#</a> Aurora HA</h3> <p>6 copies across 3 AZs:
* 4 copies for writes
* 3 copies for reads
* Self healing with p2p replication
* Storage is striped across 100s of volumes</p> <p><strong>Aurora Cluster</strong></p> <p><img src="/images/rds_aurora_cluster.png" alt="rds_aurora_cluster"></p> <ul><li>Aurora provides one <code>writer endpoint</code></li> <li>To manage read replicas, Aurora provides a <code>reader endpoint</code>. Load Balancing happens at the connection level.</li></ul> <h3 id="security-2"><a href="#security-2" class="header-anchor">#</a> Security</h3> <ul><li>It follows the same features as RDS</li> <li>Encryption at rest using KMS</li> <li>Automated backups etc are also encrypted</li> <li>Encryption in flight using SSL</li> <li>Authentication is available using IAM Token</li> <li>Instance security is up the User</li></ul> <h3 id="advanced-concepts"><a href="#advanced-concepts" class="header-anchor">#</a> Advanced Concepts</h3> <ul><li>Custom EndPoints can be created to potentially targer specific replicas, for example, when some instances are bigger than others.</li> <li>Serverless:
<ul><li>Automated DB instantiation and auto scaling based on usage</li> <li>Good for intermittent workload</li> <li>No capacity planning needed, it uses a Proxy Fleet</li></ul></li> <li>Multi-Master: If immediate failover for write node is required</li> <li>Global Aurora:
<ul><li>Cross Region replicas &amp; Global Database (up to 5 secondary read replicas, less than 1 sec latency)</li> <li>Up to 16 read replicas per secondary region</li> <li>Recovery Time Objective (RTO) &lt; 1 min</li></ul></li> <li>Machine Learning:
<ul><li>Integration between Aurora, Sagemaker and Comprehend</li></ul></li></ul> <h2 id="elastic-cache"><a href="#elastic-cache" class="header-anchor">#</a> Elastic Cache</h2> <p>Managed in-memory database (Redis/Memcache). Helps make application stateless.</p> <p><strong>DB Cache</strong></p> <p>App queries ElasticCache and if no values, get from RDS and store in ElasticCache. It helps relieve the load on the DB. Caching must have an invalidation strategy to make sure only the most current data is used.</p> <p><img src="/images/rds_elasticache.png" alt="rds_elasticache"></p> <p><strong>User Session</strong></p> <p>App queries ElasticCache and if no values, get from RDS and store in ElasticCache. It helps relieve the load on the DB. Caching must have an invalidation strategy to make sure only the most current data is used.</p> <p><img src="/images/rds_elasticache_session.png" alt="rds_elasticache_session"></p> <table><thead><tr><th style="text-align:center;">Redis</th> <th style="text-align:center;">MemCached</th></tr></thead> <tbody><tr><td style="text-align:center;">MultiAZ with AutoFailover</td> <td style="text-align:center;">Multi-node partitioning of data (sharding)</td></tr> <tr><td style="text-align:center;">Read replicas to scale reads</td> <td style="text-align:center;">No high availability</td></tr> <tr><td style="text-align:center;">Data durability usig AOF persistance</td> <td style="text-align:center;">Non persistet</td></tr> <tr><td style="text-align:center;">Back and restore</td> <td style="text-align:center;">No backup and restore</td></tr></tbody></table> <h3 id="elasticcache-security"><a href="#elasticcache-security" class="header-anchor">#</a> ElasticCache Security</h3> <ul><li>Does not support IAM Roles for within the Cache</li> <li>Redis Auth for authentication</li> <li>SSL is offered for Redis and SASL for Memcached</li></ul> <h3 id="paterns"><a href="#paterns" class="header-anchor">#</a> Paterns</h3> <ul><li>Lazy loading: Only write to Cache when getting a miss</li> <li>Write Through: Add to Cache when writing to DB</li> <li>Session Store: Store session data on Cache</li></ul> <h2 id="notes"><a href="#notes" class="header-anchor">#</a> Notes</h2> <ul><li>Once a VPC has been established, it cannot be changed.</li> <li>ElasticCache Requires heavy application code changes</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.35aca26c.js" defer></script><script src="/assets/js/2.c8d9d072.js" defer></script><script src="/assets/js/24.c946bec5.js" defer></script>
  </body>
</html>
